---
# Tools from Silicos-it
# See http://silicos-it.be.s3-website-eu-west-1.amazonaws.com/
kind: DataManagerJobDefinition
kind-version: '2021.1'
name: Virtual screening with Silicos-it tools
collection: silicos-it
repository-url: https://github.com/InformaticsMatters/virtual-screening/silicos-it.yaml
repository-tag: '1.0.0'

jobs:
  shape-it:
    name: 3D shape alignment with shape-it
    description: >-
      Perform a shape alignment of a set of 3D molecules to a reference 3D molecule using Silicos-it's shape-it tool.
    version: '1.0.0'
    category: virtual screening
    keywords:
    - alignment
    - similarity
    - shape
    - silicos-it
    - filter
    doc-url: 'https://discourse.squonk.it/t/job-shape-it/93'
    image:
      name: 3dechem/silicos-it
      tag: 'latest'
      project-directory: /data
      working-directory: /data
    command: >-
      shape-it -r '{{ refmol }}'
      -d '{{ molecules }}'
      -o '{{ outfilebase }}.sdf'
      -s '{{ outfilebase }}.tab'
      {% if cutoff is defined %}--cutoff {{ cutoff }}{% endif %}
      {% if rankBy is defined %}--rankBy '{{ rankBy }}'{% endif %}
      {% if best is defined %}--best {{ best }}{% endif %}
      {% if noref is defined %}--noref{% endif %}
    variables:
      order:
        inputs:
        - refmol
        - molecules
        options:
        - outfilebase
        - cutoff
        - rankBy
        - best
        - noref
      inputs:
        type: object
        required:
        - molecules
        - refmol
        properties:
          refmol:
            title: Molecule to align to
            mime-types:
            - chemical/x-mdl-molfile
            - chemical/x-mdl-sdfile
            type: file
          molecules:
            title: Molecules to align
            mime-types:
            - chemical/x-mdl-sdfile
            type: file
      outputs:
        type: object
        properties:
          alignments:
            title: Aligned molecules
            mime-types:
            - chemical/x-mdl-sdfile
            creates: '{{ outfilebase }}.sdf'
            type: file
          scores:
            title: Alignment scores
            mime-types:
            - text/tab-separated-values
            creates: '{{ outfilebase }}.tab'
            type: file
      options:
        type: object
        required:
        - outfilebase
        properties:
          outfilebase:
            title: Output file base name (no extension)
            type: string
            pattern: "^[A-Za-z0-9_/\\.\\-]+$"
          cutoff:
            title: Score cutoff
            type: number
            minimum: 0
            maximum: 1
          rankBy:
            title: Rank scores by
            type: string
            enum:
            - TANIMOTO
            - TVERSKY_DB
            - TVERSKY_REF
          best:
            title: Keep only this many best scores
            type: integer
            minimum: 1
          noref:
            title: Do not include reference mol in output
            type: boolean


  align-it-generate:
    name: Generate 3D phamacophores using align-it
    description: >-
      Generate 3D phamacophores for of a set of 3D molecules using Silicos-it's align-it tool.
    version: '1.0.0'
    category: virtual screening
    keywords:
    - alignment
    - similarity
    - pharmacophore
    - silicos-it
    - filter
    doc-url: 'https://discourse.squonk.it/t/job-align-it/94'
    image:
      name: 3dechem/silicos-it
      tag: 'latest'
      project-directory: /data
      working-directory: /data
    command: >-
      align-it -d '{{ molecules }}' -p '{{ pharfile }}'
    variables:
      inputs:
        type: object
        required:
        - molecules
        properties:
          molecules:
            title: Molecules to create pharmacophores
            mime-types:
            - chemical/x-mdl-sdfile
            type: file
      outputs:
        type: object
        properties:
          pharmacophore_file:
            title: Pharmacophore output file (.phar)
            mime-types:
            - squonk/align-it-phar
            creates: '{{ pharfile }}'
            type: file
      options:
        type: object
        required:
        - pharfile
        properties:
          pharfile:
            title: Output file for phamacophores
            type: string
            pattern: "^[A-Za-z0-9_/\\.\\-]+\\.phar$"
