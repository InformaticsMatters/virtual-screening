# Job: fragment-network-synthon-expansion

This describes how to run the `fragment-network-synthon-expansion` job from the `virtual screening` category in the `im-fragment-network` collection.

This uses the fragment network to find molecules that derive from a query molecule and incorporate a specific synthon.
One of more synthons can be specified, each one is evaluated in turn.
Typically synthons are generated by fragmenting a molecule using the `fragment-network-find-synthons` job.

## Implementation details

* Job implementation: [fn_synthon_expansion.py](/fn_synthon_expansion.py)
* Job definition: `jobs.fragment-network-synthon-expansion` in [fragnet-search.yaml](/data-manager/fragnet-search.yaml)

## How to run the job

### Inputs

This job has no file inputs.

### Options

* **Query SMILES**: The SMILES of the molecule to start from.
* **Synthon SMILES**: The SMILES of the synthon (1). Argument can have multiple values.
* **Output file**: The name of the output file e.g. `synthon-expansions.smi`.
* **Number of fragment network hops**: The number of edges to traverse in the fragment network. Max allowed is 4.
* **Min heavy atom count**: The minimum heavy atom count for resulting molecules.
* **Max heavy atom count**: The maximum heavy atom count for resulting molecules.
* **Min ring atom count**: The minimum ring atom count for resulting molecules.
* **Max ring atom count**: The maximum ring atom count for resulting molecules.

Notes:

(1) A typical synthon will look like this: `[Xe]CNCc1cccs1` where the Xenon atom marks the attachment point.

## Related topics

* [About the fragment network](https://squonk.it/fragnet-search-ui)
* [fragment-network-expand](fragment-network-expand.md) job
* [fragment-network-find-synthons](fragment-network-find-synthons.md) job
