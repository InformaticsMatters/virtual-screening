This describes how to run the `enumerate-candidates` job from the `virtual screening` category in the `im-virtual-screening` collection.

## What the job does
This job enumerates microstates, tautomers and undefined chiral centres of a molecules to generate a set of variants of the molecules suitable for virtual screening.

The microstates are enumerated using [Dimorphite-DL](https://durrantlab.pitt.edu/dimorphite-dl/).
Tautomers are enumerated using [RDKit's tautomer generator](http://rdkit.org/docs/source/rdkit.Chem.MolStandardize.rdMolStandardize.html?highlight=tautomerenumerator#rdkit.Chem.MolStandardize.rdMolStandardize.TautomerEnumerator).
Chiral centres are enumerated using Python code using RDKit.

The input is a file containing the molecules that need enumerating, typically generated by the [prep-enum-conf-lists](prep-enum-conf-lists.md)
job. The output is a `digest.smi` file in the sharded data structure (where `digest` is the full sha256 digest) for each 
input molecule (see the [shard](shard.md) job for details). Typically about 10 molecules are generated for each input, 
but this number varies considerably. Each enumerated molecule is a line in the `digest.smi` file which is a tab separated 
text file containing the SMILES, the UUID and a single letter code identifying which type of action has led to the creation 
of the enumerated form (B = base molecule, M = microstate, T = tautomer, C = stereoisomer).
That single letter code is pulled through into the 3D conformers that will be generated next, and hence into the docking results.

Typically the [generate-conformer](generate-conformer.md) job is run immediately after this job.

## Implementation details

This job is implemented as a [Nextflow](https://www.nextflow.io/) workflow.

* Python module: [/enumerate.py]()
* Nextflow workflow: [/enumerate.nf]()
* Job definition: `jobs.enumerate-candidates` in [/data-manager/virtual-screening.yaml]()

## How to run the job

### Inputs

* **Molecules to enumerate**:  typically the  *Molecules needing enumeration* output of the 
[prep-enum-conf-lists](prep-enum-conf-lists.md) job.
* **Directory with sharded data**: the directory with the sharded data (typically `molecules/sha256`)

### Options
This job has no user definable options

### Outputs

Outputs are written to the *sharded molecule system* with file names such as *sha256-digest*.sdf.
A single conformer of each enumerated form is written.

## Related topics

* [Description of the sharded molecule system](https://discourse.squonk.it/t/the-sharded-molecule-system/88)
* [prep-enum-conf-lists job](prep-enum-conf-lists.md)
* [assemble-conformers job](assemble-conformers.md)
* [generate-low-energy-conformers job](generate-low-energy-conformers.md)